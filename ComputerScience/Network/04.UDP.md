# UDP

### UDP

- User Datagram Protocol
- 데이터를 데이터그램 단위로 처리함.
- 비연결형, 신뢰성 X
- 전송 계층에서 사용하는 프로토콜.

### TCP와 UDP를 사용하는 이유?

- IP의 역할은 장치에서 장치의 통신을 지원함. 그러나 한 장치안에서의 많은 프로그램들 사이의 통신까지 IP가 담당하기에는 한계가 있음. → 그래서 포트번호를 사용함.
- 또한 IP에서 발생하는 오류는 ICMP가 알려주는데 ICMP는 알려주기만 할뿐 대처를 못함. IP 보다 상위에서 처리해줘야함. → IP의 상위 프로토콜인 TCP와 UDP가 나오게 됨.

**☑️ IP와 포트번호**

IP 주소의 역할

- 호스트 간 통신 : IP는 네트워크 상에서 각 장치를 유일하게 구별함.
- 데이터 라우팅 : 라우터는 IP 주소를 사용해서 패킷을 올바른 목적지로 전달.

포트 번호의 역할

- 프로세스 간 통신 : 같은 장치 내에서 여러 프로그램이 동시에 통신할 때 각 프로그램 구분용으로 포트번호를 사용.
- 세부 주소 지정 : IP 주소가 건물 주소라면, 포트 번호는 해당 건물 내의 방 번호라고 생각하면 됨.

### TCP와 UDP의 오류 해결 방법

**TCP**

- 데이터 오류 등을 자동으로 보정함으로써 **송수신 데이터의 정확한 전달**을 보장.

**UDP**

- TCP와는 달리 **에러가 날 수 도 있고 재전송 혹은 데이터의 순서가 바뀔 수도** 있음.
- 이 경우에는 응용 계층에서 처리하는 번거로움 발생.

→ 그렇다면 UDP는 에러가 발생할 수도 있는데도 사용하는 이유는 뭘까…?

### UDP를 사용하는 이유

- UDP는 일단 속도가 빠름. 데이터 처리 속도가 TCP 보다 빠름
    - 왜냐? 통신 연결의 확립 같은 3-way handshake 작업을 하지 않음(TCP는 함.)
- 그러므로 주로 실시간 방송이나 온라인 게임에서 사용됨.네트워크 환경이 좋지 않을 때 끊기는 현상 생각하면 됨.

### UDP 헤더

![272A5A385759267B36](https://github.com/Audrey-1120/cs-study/assets/100057254/77fa3092-25d5-435e-ae04-1fe54f73e334)

Source port : 시작 포트

Destination port : 도착 포트

Length : 길이

Checksum : 오류 검출

- 데이터의 무결성을 확인하는데 사용되는 간단한 오류 검출 기법임. 네트워크 통신이나 파일 전송 중 데이터가 손상되거나 변경되지 않았는지 확인하는데 사용함.

UDP의 헤더는 TCP에 비해 간단하기 때문에 TCP보다 용량이 가볍고 송신 속도가 빠르게 작동됨.

### DNS가 UDP를 사용하는 이유

먼저 DNS란 도메인 이름을 IP 주소로 변환해주는 시스템임. 쉽게 말해서 사람이 읽을 수 있는 도메인 이름(www.example.com)을 컴퓨터가 이해할 수 있는 IP 주소(192.0.0.1) 로 바꿔주는 역할.

1. 간단한 요청/응답 구조
    - DNS 요청 : [www.example.com](http://www.example.com)의 IP 주소 알려주세요!
    - DNS 응답 : 192.0.0.1입니다!!
    - 위와 같이 DNS 쿼리는 요청과 응답이 매우 간단함. 보통 요청과 응답 모두 한번으로 끝나기 때문에 간단하고 빠른 통신 필요로함.
2. 작은 데이터 크기
    - 대부분의 DNS 쿼리 및 응답은 크기가 작음. → 512 바이트 이하의 UDP 패킷으로 충분함.
3. 낮은 오버헤드
    - UDP는 연결 설정 없이 바로 데이터를 보내서 오버헤드가 낮은데 비해 TCP는 데이터 전송 전에 3-way handshake과정을 거친 다음, 데이터가 제대로 도착했는지 확인해야해서 시간도 더 걸리고 오버헤드도 더큼.
4. 응용 계층에서의 신뢰성
    - UDP는 기본적으로 신뢰성이 없지만 여기에서 생기는 오류들을 응용계층에서 처리할 수 있음.
        - ex) 응답이 오지 않으면 재요청 보냄.

### 그러나 DNS가 TCP를 사용할 때도 있다!

1. Zone Transfer
    - 이는 DNS 서버 간에 대량의 데이터를 주고받는 경우.
    - 이때는 데이터가 크고 신뢰성이 중요하므로 TCP 사용
2. 데이터 크기 초과
    - DNS 응답이 512 바이트를 초과하는 경우, UDP로는 처리 어려우므로 TCP 사용
3. 응답 실패 
    - UDP로 요청했지만 응답을 받지 못한 경우, TCP로 다시 요청함.
        - 왜냐? TCP는 신뢰성 있는 전송 보장.